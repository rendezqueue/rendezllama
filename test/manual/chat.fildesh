#!/usr/bin/env fildesh

# This script isn't guaranteed to be stable.
# Prefer the local.sh one.

(: scene Str (?? .self.opt.scene "roshambo_0"))
(: model_file Filename
 (?? .self.opt.model
  "/mnt/llama_model_data/llama_cpp_models/13B/ggml-model-q4_0.bin"))
(: setting_file Filename (++ "example/prompt/" scene "/setting.sxproto"))
(: thread_count Str (?? .self.opt.thread_count "16"))

|< stdin
|- ./bld/src/chat/chat \
  --x_setting $(XOF setting_file) \
  --o_rolling "bld/example/prompt/${scene}.txt" \
  --thread_count "${thread_count}" \
  --model $(XOF model_file)
|> stdout

